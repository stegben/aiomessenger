language: python

cache: pip

python:
- '3.5'
- '3.6'
- nightly

matrix:
  allow_failures:
  - python: nightly

before_install:
- sudo apt-get update
- sudo apt-get install pandoc -y
- pip install pipenv codecov

install:
- pipenv install --dev

script:
- pipenv run make lint
- pipenv run make test

deploy:
  provider: pypi
  user: stegben
  password:
    secure: iNM+wRZue8ETXRZkPwYq9LcGOhf9HwWUnRR9r4LERhqR/1JVtR7zLRMstvoL6TZtk35QlKTFGPFSf1wk6HQC1i+Z6nGtDqcAQH0iep2uPba6PZy2T0MuvT1w5Qdv8xiiR7E7AFs76LrsYpQXBxrM/+qrah4joMcyhuK1ggA8otHPLUR/M0B3/UlzY+FkAeGQfrweuQl4ARk0oZW8kYbkn/ceKEdVS0Pa0OrUngFISdZ2hGbCibPFEMyg9fpuh8L4LUcJ0VvvYLVWC3YaMaa0h/W4DUfUoLtbSRYZR6sclf3jHMDp4FfjogeWNeWUbihKKhGbydEYplVmhKTpJwFQ2RMwGIPbMnxTHdTzPjE6k3l0v8xfpGZBKPp+UOEk4crOrngz++7EXwERsbZwljfQgu9sQX3ZtUcRjAMN37tGI2/dK2jKHieMFuZBWgDDyEixDY6474QMriPn95/yPP5UkaDNxwVJnPzZtMoEkWIpkyH/fu4J8npmhmoJAgU5enGgTXG7ROI1lt3CGgcmh4yqPt1SiZSSncg6M/N9+AlJdAjbmp70aN8J0sahIorVFQMy3+//DR1YuI8MlUvvtdElVPM7QZD3gdGbxOoSO6BwB1y5a67+r5GBRxR/T2J5rKE6Hs35GQX8zHE1iQAErMdUdRw0mygUM9vFzeBJgie3LKY=
  on:
    tags: true
    distributions: sdist bdist_wheel
    repo: stegben/aiomessenger

after_success:
- codecov
