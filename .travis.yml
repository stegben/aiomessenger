language: python

cache: pip

python:
- '3.5'
- '3.6'
- 'nightly'

matrix:
  allow_failures:
  - python: 'nightly'

before_install:
  - sudo apt-get update
  - sudo apt-get install pandoc -y
  - pip install pipenv codecov

install:
- pipenv install --dev

script:
- pipenv run make lint
- pipenv run make test

deploy:
  provider: pypi
  user: stegben
  password:
    secure: BC11sTsiOKRwujOCuOQ9efZSv7fBAL7QC152XDx0MH6aH56WngihJwE/7C2/UXvuG3m/LjEQ0zOxIQ0Dzo9xVVxyBIMRmCLDGIZWePGqTbsskBzphbpC4vzVLyZ87B0pv4MEQCuwExVNvA+1I/ZIzbuKS3zy8rZibJ93vxdIv1lm6pwGO2tXCWohtt8o/cd2ULJc4lH3gXkuOVnuW6+fkRFd1ixerS0Anhs6sZN6otMl8y7zLFBwAwevJpakaBGf5sH+bQwjDwnJZ0H2g3/sGMHiYO45DzgmpkPs7nehpmXuPDYXG/tcJ0nyylZiGT7AcyRyZKtyXqo3cdCZiNfs/VQCJFQx+ch+Wrq5Mf/xOHU25JJ1vkEEyPKYZKFLqNVN/+XFo4VkpCdBaaG7OKlfQFUCZ70A3Jftk0gyAMxVm4vqTZ83Fa8qxa/3xC9UaDi3u0bGFWT5m7ppg0+z0BQeuYJc/3014l3Zha8tNST6BURWZiSVwnq+F0y/5gm92PauG9SM7xgayV3tvN/uTV6S8stN1hGQ83Bnl11j5uYLNlNDEczBdayCV10zeyDrDari/D2MQBqMslypG+whb9AH/bwuZASW2zDLBID9ecyWQR+8+q6bHzrlB0ni9nvxiKy33nqQMg2HfSYUeQyxoIoYR+j/fH8trSnDQ4sbaVvLavE=
  distributions: sdist
  skip_upload_docs: true
  skip_cleanup: true
  on:
    tags: true
    python: 3.6

after_success:
  - codecov
