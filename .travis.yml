language: python

cache: pip

python:
- '3.5'
- '3.6'
- nightly

matrix:
  allow_failures:
  - python: nightly

before_install:
- sudo apt-get update
- sudo apt-get install pandoc -y
- pip install pipenv codecov

install:
- pipenv install --dev

script:
- pipenv run make lint
- pipenv run make test

deploy:
  provider: pypi
  user: stegben
  password:
    secure:  "R2hdm6RZFyF4Y1liVmu81d8/JPCerI54iER/LmBZ5dIM+moIYT4Pf5euFJE5cICSmvkEOnzl2vKxRNUXAg7kzmjIJoeQFTuraoqr/c09cn6d627eX7DYde5OkRmPDsF/N26uP4vhTeab6E9Bv8rANmwTYSzCeidSBeGXvku1hNMwXxmMLHo3/5QIy/NiBiPYh/vqi/ZUKsQeYipVhv473Cp7KWBYclglPTQqewBEDfbMax8gjFeZyqETauOUvv6jOM5NQvQREi8X3YxU7s0yy/0hEG1s8xwZ/Cekdy/A9H4CKjXmW89NXHCNii3Xt80bAV0VHLtshma5QPgqHIfhl2QqdKr1NKjjHrcrjOtzNIjiNRwCyButWlI+IwhAbdr/Zm4YRcUmefvHeyqakwgMgqeK6jDKC1VWk+ZTyzs7eISE5tV2W6Z5HMDHXZZTQ708DSnZmeETscpJVY6rrQLRUoRw7VELzJlZl5493+D1gIlI4lrX2NtVxwbg0g7TrpOeQAi6+jH9yc2OyZXT0vDC/QZY0/olz1IydJozxc1GG6sOnHc98ftNd3tbfo3Mpicmr5FdIWvIE2+1Uoy5Xa2A1t3Gzc6bWUqtCAgxu79GyPOaJ5dLN/lnBT0uq8lJyByZqKXwybEp11SrVr3kt7LR613o4mzuSzEiI6YC3cNjpHo="
  on:
    tags: true
    distributions: sdist bdist_wheel
    repo: stegben/aiomessenger

after_success:
- codecov
