language: python

cache: pip

python:
- '3.5'
- '3.6'
- 'nightly'

matrix:
  allow_failures:
  - python: 'nightly'

before_install:
  - sudo apt-get update
  - sudo apt-get install pandoc -y
  - pip install pipenv codecov

install:
- pipenv install --dev

script:
- pipenv run make lint
- pipenv run make test

deploy:
  provider: pypi
  user: stegben
  password:
    secure: "mmYhdgVLiKr1YV67c0eUgj/m9pJKSM7FMyM0efDxPOeOEV1UUoUfI6Isy5HqXWqIA68HwJRZgSamCh9l7o2P2CPFX+fiS4ylQRYozQaC1GYwIwEsLbmSQDcmcuEZN1KlrmdtvigN6diJ6RY8641+YlbYWi/CjX8+6sRSqAof/OAlIPRDZHprLM353hE4pX+RPVztAFcjufuh89Xecj+G7t1lC04Yzh3fcDU74/OJgYQJVlIwdNAi7QzW/2WwzZVID2kn4v5L5A9uoNuoXqnFafF5xeqESIvlKyuGXaJMMYZjUuCvxTJzL9rISKC7WboXI3HJzzhsoRepSWFMgn1X5LpgCvvQO2lQ4hzYUgAPd504b79gmEpfE9cz7ysv1CdQD89+Pz/if5KE7SjDzBWp7dWK1QApHWJMwkvsyyFqwirWvKNSCr9yG+xTitn1QCgnqH6dZaD/h56dThTIyUIQjV3hFAP8lWnxQRdejD6yT5awTJZKCRVFci/zfB5QJR/JHOVsjUs+EDr1nr/i7FzYcVKWKC7ddyUaukrKCshu932j6kwSBgZK+aBqcNGZJhhHRK0g7yEtybZUTmMee51LqFWro1LQkY4Wbr200LYfDNcIsbQKGI1+X9QVYCINXGaL/XXTGOdrwHm33nGYulEks75FPGsh0dqlpK85z2XTihY="
  distributions: sdist
  skip_upload_docs: true
  skip_cleanup: true
  on:
    tags: true
    python: 3.6

after_success:
  - codecov
