language: python

cache: pip

python:
- '3.5'
- '3.6'
- 'nightly'

matrix:
  allow_failures:
  - python: 'nightly'

before_install:
  - sudo apt-get update
  - sudo apt-get install pandoc -y
  - pip install pipenv codecov

install:
- pipenv install --dev

script:
- pipenv run make lint
- pipenv run make test

deploy:
  provider: pypi
  user: stegben
  password:
    secure: "V4M2OOK9MoHRMQp6mak6YctWgTaJl4eNeR4UbFq/UVQuK26ABIFRiSIXfYLjh3icAqb57ufXF53WRvQM4Wg8zBqQapzLF6AANN1f/+cdm3iw8aMuFuMIPFJJ544kT7eyRX1EHSiEFo0YKk3m1PIkwMANLDWPDitJ4S8Y+I9p3tfu9NXw88CUIby/AHeS/gYUu7t4qUeyK82agyVRbmFZalgFllnrqZnMJtCalr2tIuZI3jsX+gaqKXqGqvtDetewA+cEWurjyFRmYdQqhojNn4ETvtMF5T2NpJCVgQDn8GOYTyuTAG4FpL7/y0ZAX/qPRz1suKsrYjGZPN39w8DtFG5pby2ALECxTZ89rAGV0SEPffLhyrn7+SJ8/6Y5SMGM5RM7tPVpP6GjlR+3VTuzbB6k4ZW01CVl7TlDiAt1ZGJQcpY+eb9zmqcIyd/5ShUyF4g1Zad5h3xUdksoES1hoOqob2/urob4eJIqCguAfv2QVKqX1XmDC2+qk4GORkFnhpNuWcWckrmrEdC4JH8FDl3VdEFgxq4ZcYmtVTw/II6vAlpPDUKG+Qo3m0CDxtNZtifZv7Kb6qR7kD6EyLXvd+vF+eSJMGqleG6mTVYQEpFOOihQJ0V4aXwh/QSVBRK5qLaqCPEUZFmV/Pk1C/SDxEYnXgwPCGmmvYR7cjc020A="
  distributions: sdist
  skip_upload_docs: true
  skip_cleanup: true
  on:
    tags: true
    python: 3.6

after_success:
  - codecov
